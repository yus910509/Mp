<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tokoshop Dashboard - Frontend</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body {background:#f7f9fc}
    .sidebar {min-height:100vh}
    .card-small {min-height:110px}
    .table-responsive {max-height:420px; overflow:auto}
  </style>
</head>
<body>
  <div class="container-fluid">
    <div class="row">
      <!-- SIDEBAR -->
      <nav class="col-md-2 d-none d-md-block bg-white sidebar border-end py-3">
        <div class="px-3">
          <h4 class="mb-4">Tokoshop</h4>
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link active" href="#dashboard"> <i class="fa fa-home me-2"></i> Dashboard</a></li>
            <li class="nav-item"><a class="nav-link" href="#users"> <i class="fa fa-users me-2"></i> Manajemen Users</a></li>
            <li class="nav-item"><a class="nav-link" href="#suppliers"> <i class="fa fa-truck me-2"></i> Supplier</a></li>
            <li class="nav-item"><a class="nav-link" href="#customers"> <i class="fa fa-user-check me-2"></i> Pelanggan</a></li>
            <li class="nav-item"><a class="nav-link" href="#products"> <i class="fa fa-boxes-stacked me-2"></i> Produk</a></li>
            <li class="nav-item"><a class="nav-link" href="#transactions"> <i class="fa fa-receipt me-2"></i> Transaksi</a></li>
            <li class="nav-item"><a class="nav-link" href="#reports"> <i class="fa fa-chart-line me-2"></i> Laporan</a></li>
          </ul>
        </div>
      </nav>

      <!-- MAIN CONTENT -->
      <main class="col-md-10 ms-sm-auto col-lg-10 px-md-4">
        <!-- TOPBAR -->
        <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
          <div class="container-fluid px-3">
            <a class="navbar-brand" href="#">Dashboard</a>
            <div class="d-flex align-items-center ms-auto">
              <div class="me-3">Welcome, <strong>Superadmin</strong></div>
              <button class="btn btn-outline-secondary btn-sm">Logout</button>
            </div>
          </div>
        </nav>

        <div class="p-3">
          <!-- Dashboard / Slider -->
          <section id="dashboard">
            <div class="row gy-3">
              <div class="col-lg-8">
                <div id="promoCarousel" class="carousel slide" data-bs-ride="carousel">
                  <div class="carousel-inner rounded shadow-sm">
                    <div class="carousel-item active">
                      <img src="https://via.placeholder.com/900x250?text=Promo+1" class="d-block w-100" alt="Promo 1">
                    </div>
                    <div class="carousel-item">
                      <img src="https://via.placeholder.com/900x250?text=Promo+2" class="d-block w-100" alt="Promo 2">
                    </div>
                    <div class="carousel-item">
                      <img src="https://via.placeholder.com/900x250?text=Promo+3" class="d-block w-100" alt="Promo 3">
                    </div>
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#promoCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#promoCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon"></span>
                  </button>
                </div>

                <!-- Quick Stats -->
                <div class="row mt-3">
                  <div class="col-sm-4">
                    <div class="card card-small p-3">
                      <div>Total Users</div>
                      <h3 id="stat-users">12</h3>
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="card card-small p-3">
                      <div>Products</div>
                      <h3 id="stat-products">78</h3>
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="card card-small p-3">
                      <div>Orders (this month)</div>
                      <h3 id="stat-orders">34</h3>
                    </div>
                  </div>
                </div>

              </div>

              <!-- Right column: Small charts -->
              <div class="col-lg-4">
                <div class="card p-3 shadow-sm">
                  <h6>Ringkasan Penjualan</h6>
                  <canvas id="miniSalesChart" height="150"></canvas>
                </div>
              </div>
            </div>
          </section>

          <!-- Users Management -->
          <section id="users" class="mt-5">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h4>Manajemen Users</h4>
              <div>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#userModal">Tambah User</button>
              </div>
            </div>
            <div class="card p-3">
              <div class="mb-3 d-flex gap-2">
                <select id="filterRole" class="form-select w-auto">
                  <option value="all">Semua role</option>
                  <option value="superadmin">Superadmin</option>
                  <option value="admin">Admin</option>
                  <option value="kasir">Kasir</option>
                </select>
                <input id="searchUser" class="form-control w-50" placeholder="Cari user...">
              </div>
              <div class="table-responsive">
                <table class="table table-striped">
                  <thead><tr><th>#</th><th>Nama</th><th>Email</th><th>Role</th><th>Aksi</th></tr></thead>
                  <tbody id="usersTable"></tbody>
                </table>
              </div>
            </div>
          </section>

          <!-- Suppliers -->
          <section id="suppliers" class="mt-5">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h4>Manajemen Supplier</h4>
              <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#supplierModal">Tambah Supplier</button>
            </div>
            <div class="card p-3">
              <div class="table-responsive">
                <table class="table table-hover">
                  <thead><tr><th>#</th><th>Nama Supplier</th><th>Kontak</th><th>Alamat</th><th>Aksi</th></tr></thead>
                  <tbody id="supplierTable"></tbody>
                </table>
              </div>
            </div>
          </section>

          <!-- Customers -->
          <section id="customers" class="mt-5">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h4>Manajemen Pelanggan</h4>
              <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#customerModal">Tambah Pelanggan</button>
            </div>
            <div class="card p-3">
              <div class="mb-3 d-flex gap-2">
                <select id="filterCustType" class="form-select w-auto">
                  <option value="all">Semua tipe</option>
                  <option value="umum">Umum</option>
                  <option value="semi">Semi</option>
                  <option value="member">Member</option>
                </select>
              </div>
              <div class="table-responsive">
                <table class="table">
                  <thead><tr><th>#</th><th>Nama</th><th>Tipe</th><th>Kontak</th><th>Aksi</th></tr></thead>
                  <tbody id="customerTable"></tbody>
                </table>
              </div>
            </div>
          </section>

          <!-- Products -->
          <section id="products" class="mt-5">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h4>Manajemen Produk</h4>
              <div>
                <button class="btn btn-outline-secondary me-2" data-bs-toggle="modal" data-bs-target="#categoryModal">Kategori</button>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#productModal">Tambah Produk</button>
              </div>
            </div>
            <div class="card p-3">
              <div class="table-responsive">
                <table class="table table-bordered">
                  <thead><tr><th>#</th><th>Kategori</th><th>Nama Produk</th><th>SKU</th><th>Stok</th><th>Harga</th><th>Aksi</th></tr></thead>
                  <tbody id="productTable"></tbody>
                </table>
              </div>
            </div>
          </section>

          <!-- Transactions -->
          <section id="transactions" class="mt-5">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h4>Transaksi</h4>
              <div>
                <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#orderModal">Buat Pesanan</button>
              </div>
            </div>
            <div class="card p-3">
              <h6>Daftar Pesanan</h6>
              <div class="table-responsive">
                <table class="table table-sm">
                  <thead><tr><th>#</th><th>Invoice</th><th>Pelanggan</th><th>Total</th><th>Status</th><th>Aksi</th></tr></thead>
                  <tbody id="orderTable"></tbody>
                </table>
              </div>

              <hr>
              <h6>Data Cicilan</h6>
              <div class="table-responsive">
                <table class="table table-sm">
                  <thead><tr><th>#</th><th>Invoice</th><th>Pelanggan</th><th>Jumlah Cicilan</th><th>Status</th></tr></thead>
                  <tbody id="installmentTable"></tbody>
                </table>
              </div>
            </div>
          </section>

          <!-- Reports -->
          <section id="reports" class="mt-5 mb-5">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h4>Laporan & Chart</h4>
              <button class="btn btn-outline-primary" id="exportPdf">Export PDF (placeholder)</button>
            </div>
            <div class="row">
              <div class="col-md-6">
                <div class="card p-3">
                  <h6>Penjualan Bulanan</h6>
                  <canvas id="salesChart" height="200"></canvas>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card p-3">
                  <h6>Produk Terlaris</h6>
                  <canvas id="topProductsChart" height="200"></canvas>
                </div>
              </div>
            </div>
          </section>

        </div>
      </main>
    </div>
  </div>

  <!-- --- MODALS (users, suppliers, customers, products, orders) --- -->
  <!-- User Modal -->
  <div class="modal fade" id="userModal" tabindex="-1">
    <div class="modal-dialog">
      <form class="modal-content" id="userForm">
        <div class="modal-header"><h5 class="modal-title">Tambah / Edit User</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <input type="hidden" id="userId">
          <div class="mb-3"><label>Nama</label><input id="userName" class="form-control"></div>
          <div class="mb-3"><label>Email</label><input id="userEmail" class="form-control"></div>
          <div class="mb-3"><label>Role</label>
            <select id="userRole" class="form-select"><option value="superadmin">Superadmin</option><option value="admin">Admin</option><option value="kasir">Kasir</option></select>
          </div>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button><button class="btn btn-primary" type="submit">Simpan</button></div>
      </form>
    </div>
  </div>

  <!-- Supplier Modal -->
  <div class="modal fade" id="supplierModal" tabindex="-1">
    <div class="modal-dialog">
      <form class="modal-content" id="supplierForm">
        <div class="modal-header"><h5 class="modal-title">Tambah Supplier</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <input type="hidden" id="supplierId">
          <div class="mb-3"><label>Nama</label><input id="supplierName" class="form-control"></div>
          <div class="mb-3"><label>Kontak</label><input id="supplierContact" class="form-control"></div>
          <div class="mb-3"><label>Alamat</label><textarea id="supplierAddress" class="form-control"></textarea></div>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button><button class="btn btn-primary" type="submit">Simpan</button></div>
      </form>
    </div>
  </div>

  <!-- Customer Modal -->
  <div class="modal fade" id="customerModal" tabindex="-1">
    <div class="modal-dialog">
      <form class="modal-content" id="customerForm">
        <div class="modal-header"><h5 class="modal-title">Tambah Pelanggan</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <input type="hidden" id="customerId">
          <div class="mb-3"><label>Nama</label><input id="customerName" class="form-control"></div>
          <div class="mb-3"><label>Tipe</label>
            <select id="customerType" class="form-select"><option value="umum">Umum</option><option value="semi">Semi</option><option value="member">Member</option></select>
          </div>
          <div class="mb-3"><label>Kontak</label><input id="customerContact" class="form-control"></div>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button><button class="btn btn-primary" type="submit">Simpan</button></div>
      </form>
    </div>
  </div>

  <!-- Category Modal -->
  <div class="modal fade" id="categoryModal" tabindex="-1">
    <div class="modal-dialog">
      <form class="modal-content" id="categoryForm">
        <div class="modal-header"><h5 class="modal-title">Tambah Kategori</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div class="mb-3"><label>Nama Kategori</label><input id="categoryName" class="form-control"></div>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button><button class="btn btn-primary" type="submit">Simpan</button></div>
      </form>
    </div>
  </div>

  <!-- Product Modal -->
  <div class="modal fade" id="productModal" tabindex="-1">
    <div class="modal-dialog">
      <form class="modal-content" id="productForm">
        <div class="modal-header"><h5 class="modal-title">Tambah Produk</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div class="mb-3"><label>Nama Produk</label><input id="productName" class="form-control"></div>
          <div class="mb-3"><label>Kategori</label><select id="productCategory" class="form-select"></select></div>
          <div class="mb-3"><label>SKU</label><input id="productSku" class="form-control"></div>
          <div class="mb-3"><label>Stok</label><input id="productStock" type="number" class="form-control" value="0"></div>
          <div class="mb-3"><label>Harga</label><input id="productPrice" type="number" class="form-control" value="0"></div>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button><button class="btn btn-primary" type="submit">Simpan</button></div>
      </form>
    </div>
  </div>

  <!-- Order Modal (simple) -->
  <div class="modal fade" id="orderModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <form class="modal-content" id="orderForm">
        <div class="modal-header"><h5 class="modal-title">Buat Pesanan</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div class="mb-3 d-flex gap-2">
            <select id="orderCustomer" class="form-select w-50"></select>
            <select id="orderProduct" class="form-select w-50"></select>
          </div>
          <div class="mb-3 d-flex gap-2"><input id="orderQty" type="number" min="1" value="1" class="form-control w-25"><button id="addToCart" class="btn btn-secondary">Tambah</button></div>
          <div><h6>Cart</h6><table class="table table-sm"><thead><tr><th>Produk</th><th>Qty</th><th>Harga</th><th>Total</th><th></th></tr></thead><tbody id="cartTable"></tbody></table></div>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button><button class="btn btn-success" type="submit">Simpan Pesanan</button></div>
      </form>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // ---------- Sample in-memory data store (replace with API calls later) ----------
    const state = {
      users: [
        {id:1,name:'Admin Utama',email:'super@tokoshop.test',role:'superadmin'},
        {id:2,name:'Rina',email:'rina@tokoshop.test',role:'admin'},
        {id:3,name:'Budi',email:'budi@tokoshop.test',role:'kasir'}
      ],
      suppliers:[{id:1,name:'CV.Supply',contact:'081234',address:'Jakarta'}],
      customers:[{id:1,name:'Toko A',type:'member',contact:'081111'},{id:2,name:'Budi',type:'umum',contact:'082222'}],
      categories:['Elektronik','Peralatan'],
      products:[{id:1,category:'Elektronik',name:'Speaker',sku:'SP001',stock:10,price:250000},{id:2,category:'Peralatan',name:'Panci',sku:'PC001',stock:20,price:75000}],
      orders:[],
      installments:[],
    };

    // ---------- Utilities ----------
    function $(id){return document.getElementById(id)}

    // ---------- Render functions ----------
    function renderUsers(){
      const tbody = $('usersTable'); tbody.innerHTML='';
      const roleFilter = $('filterRole').value; const q = $('searchUser').value.toLowerCase();
      state.users.filter(u => (roleFilter==='all'||u.role===roleFilter) && (u.name.toLowerCase().includes(q) || u.email.toLowerCase().includes(q))).forEach((u,i)=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${i+1}</td><td>${u.name}</td><td>${u.email}</td><td>${u.role}</td><td><button class='btn btn-sm btn-outline-secondary me-1' onclick="editUser(${u.id})">Edit</button><button class='btn btn-sm btn-danger' onclick="deleteUser(${u.id})">Hapus</button></td>`;
        tbody.appendChild(tr);
      });
      $('stat-users').textContent = state.users.length;
    }

    function renderSuppliers(){
      const tbody = $('supplierTable'); tbody.innerHTML='';
      state.suppliers.forEach((s,i)=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${i+1}</td><td>${s.name}</td><td>${s.contact}</td><td>${s.address}</td><td><button class='btn btn-sm btn-danger' onclick='deleteSupplier(${s.id})'>Hapus</button></td>`;tbody.appendChild(tr)});
    }

    function renderCustomers(){
      const tbody = $('customerTable'); tbody.innerHTML='';
      state.customers.forEach((c,i)=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${i+1}</td><td>${c.name}</td><td>${c.type}</td><td>${c.contact}</td><td><button class='btn btn-sm btn-danger' onclick='deleteCustomer(${c.id})'>Hapus</button></td>`;tbody.appendChild(tr)});
    }

    function renderCategories(selectId){
      const sel = $(selectId); sel.innerHTML=''; state.categories.forEach(cat=>{const 

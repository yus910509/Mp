<!--
File: toko-undangan.html
Deskripsi: Single-file demo toko undangan berbasis web dengan 30 template.
Teknologi: HTML5, Bootstrap 5, vanilla JavaScript, CSS. Menggunakan html2canvas (via CDN) untuk eksport preview ke gambar.
Cara pakai: buka file ini di browser. Untuk integrasi pembayaran/penyimpanan order, hubungkan ke backend (Google Apps Script atau server Anda).

Fitur:
- Halaman katalog menampilkan 30 template undangan (thumbnail + judul + harga)
- Preview template interaktif: ubah nama, tanggal, lokasi, catatan
- Add to cart, lihat keranjang, checkout form (nama pembeli + email + catatan)
- Download preview sebagai gambar (PNG) sebelum checkout
- Template menggunakan kombinasi CSS untuk tampil estetik; gambar thumbnail placeholder dapat diganti.

Catatan: ini adalah implementasi front-end lengkap. Untuk menyimpan pesanan ke server, ubah bagian checkout untuk POST ke endpoint backend Anda.
-->

<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Toko Undangan - 30 Template Estetik</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body{background:#f8fafc;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    .card-template{cursor:pointer; transition:transform .15s ease, box-shadow .15s ease}
    .card-template:hover{transform:translateY(-6px); box-shadow:0 10px 30px rgba(0,0,0,.08)}
    .template-thumb{height:200px; object-fit:cover; border-radius:8px}
    .template-preview{width:480px; padding:24px; background:#fff; border-radius:12px; box-shadow:0 8px 28px rgba(0,0,0,.08)}
    .t-center{text-align:center}
    .badge-price{background:#0d6efd;color:#fff;padding:6px 10px;border-radius:50px}
    .nav-brand{font-weight:700}
    /* contoh gaya untuk beberapa template; setiap template bisa punya kelas unik */
    .tpl-1{background:linear-gradient(135deg,#ffe7e7,#fff5f0);padding:36px;border-radius:12px}
    .tpl-2{background:linear-gradient(135deg,#f0f8ff,#f7fff0);padding:36px;border-radius:12px}
    .tpl-3{background:#fffef6;padding:36px;border-radius:12px; border:1px dashed #e6dfc6}
    .tpl-title{font-family: 'Georgia', serif; font-size:24px; letter-spacing:1px}
    .tpl-sub{color:#6b6b6b}
    /* responsive preview in modal */
    @media (max-width:576px){ .template-preview{width:320px;padding:16px} }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg bg-white shadow-sm">
    <div class="container">
      <a class="navbar-brand nav-brand" href="#">TokoUndangan</a>
      <div class="d-flex align-items-center">
        <button class="btn btn-outline-primary me-2" id="btnCart">Keranjang (<span id="cartCount">0</span>)</button>
        <button class="btn btn-primary" id="btnCheckoutTop">Checkout</button>
      </div>
    </div>
  </nav>

  <main class="container mt-4">
    <div class="row mb-3">
      <div class="col-md-8">
        <h2>Template Undangan Estetik</h2>
        <p class="text-muted">Pilih dari 30 template cantik — klik pada template untuk melihat preview dan kustomisasi.</p>
      </div>
      <div class="col-md-4 text-md-end align-self-center">
        <div class="btn-group">
          <button class="btn btn-outline-secondary" id="filterAll">Semua</button>
          <button class="btn btn-outline-secondary" id="filterWedding">Pernikahan</button>
          <button class="btn btn-outline-secondary" id="filterBirthday">Ulang Tahun</button>
        </div>
      </div>
    </div>

    <div class="row" id="catalog"></div>

    <hr class="my-4">
    <h4>Detail Keranjang</h4>
    <div id="cartBox" class="card p-3 shadow-sm">
      <div id="cartList"></div>
      <div class="d-flex justify-content-between align-items-center mt-3">
        <div><strong>Total:</strong> Rp <span id="cartTotal">0</span></div>
        <div>
          <button class="btn btn-outline-danger btn-sm" id="clearCart">Bersihkan</button>
          <button class="btn btn-primary btn-sm" id="btnCheckout">Lanjut ke Checkout</button>
        </div>
      </div>
    </div>

  </main>

  <!-- Modal Preview -->
  <div class="modal fade" id="previewModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content p-3">
        <div class="modal-header border-0">
          <h5 class="modal-title">Preview Template</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body d-flex gap-3">
          <div id="previewArea" class="template-preview" style="flex:0 0 auto"></div>
          <div style="flex:1 1 auto">
            <h6>Pengaturan</h6>
            <div class="mb-2">
              <label class="form-label">Nama (Judul)</label>
              <input id="inputName" class="form-control" placeholder="Nama Pengantin / Nama Acara">
            </div>
            <div class="mb-2">
              <label class="form-label">Tanggal & Waktu</label>
              <input id="inputDate" class="form-control" placeholder="25 Desember 2025, 10:00 WIB">
            </div>
            <div class="mb-2">
              <label class="form-label">Lokasi</label>
              <input id="inputPlace" class="form-control" placeholder="Gedung Serbaguna, Jakarta">
            </div>
            <div class="mb-2">
              <label class="form-label">Catatan / RSVP</label>
              <input id="inputNote" class="form-control" placeholder="Mohon konfirmasi...">
            </div>
            <div class="d-flex gap-2 mt-3">
              <button class="btn btn-success" id="btnDownload">Download PNG</button>
              <button class="btn btn-primary" id="btnAddToCart">Tambahkan ke Keranjang</button>
            </div>
            <hr>
            <div>
              <small class="text-muted">Harga template saat ini: Rp <span id="previewPrice">0</span></small>
            </div>
          </div>
        </div>
        <div class="modal-footer border-0">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Checkout -->
  <div class="modal fade" id="checkoutModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Checkout</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <form id="checkoutForm">
            <div class="mb-3">
              <label class="form-label">Nama Pembeli</label>
              <input id="buyerName" class="form-control" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Email</label>
              <input id="buyerEmail" type="email" class="form-control" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Catatan (opsional)</label>
              <textarea id="buyerNote" class="form-control" rows="2"></textarea>
            </div>
            <div class="mb-3">
              <strong>Total: Rp <span id="checkoutTotal">0</span></strong>
            </div>
            <div class="text-end">
              <button type="submit" class="btn btn-primary">Bayar (Simulasi)</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Data 30 template
    const templates = Array.from({length:30}, (_,i)=>{
      const id = i+1;
      const category = (i%3==0)?'Pernikahan':(i%3==1)?'Ulang Tahun':'Resepsi';
      return {
        id: id,
        title: `Template #${id}`,
        price: (id%5===0)?25000:20000,
        category: category,
        thumb: `https://picsum.photos/seed/inv${id}/600/400`,
        styleClass: 'tpl-'+((id%6)+1)
      };
    });

    // State
    let cart = [];
    let currentPreview = null;

    // Helpers
    function currency(n){ return Number(n).toLocaleString('id-ID'); }

    // Render catalog
    const catalogEl = document.getElementById('catalog');
    function renderCatalog(list=templates){
      catalogEl.innerHTML = '';
      list.forEach(t => {
        const col = document.createElement('div'); col.className='col-sm-6 col-md-4 col-lg-3 mb-3';
        col.innerHTML = `
          <div class="card card-template h-100" data-id="${t.id}">
            <img src="${t.thumb}" class="card-img-top template-thumb" alt="${t.title}">
            <div class="card-body">
              <h6 class="card-title mb-1">${t.title}</h6>
              <div class="d-flex justify-content-between align-items-center">
                <small class="text-muted">${t.category}</small>
                <span class="badge-price">Rp ${currency(t.price)}</span>
              </div>
            </div>
          </div>
        `;
        col.querySelector('.card-template').addEventListener('click',()=> openPreview(t));
        catalogEl.appendChild(col);
      });
    }

    renderCatalog();

    // Preview modal logic
    const previewModal = new bootstrap.Modal(document.getElementById('previewModal'));
    const previewArea = document.getElementById('previewArea');
    const inputName = document.getElementById('inputName');
    const inputDate = document.getElementById('inputDate');
    const inputPlace = document.getElementById('inputPlace');
    const inputNote = document.getElementById('inputNote');
    const previewPrice = document.getElementById('previewPrice');

    function openPreview(tpl){
      currentPreview = JSON.parse(JSON.stringify(tpl)); // clone
      // set default values
      inputName.value = 'Nama & Pasangan';
      inputDate.value = '25 Desember 2025, 10:00 WIB';
      inputPlace.value = 'Gedung Serbaguna, Jakarta';
      inputNote.value = 'Mohon konfirmasi ke 0812xxxx';
      previewPrice.innerText = currency(currentPreview.price);
      renderPreview();
      previewModal.show();
    }

    function renderPreview(){
      if(!currentPreview) return;
      // build HTML for previewArea using styleClass
      previewArea.className = 'template-preview ' + currentPreview.styleClass;
      previewArea.innerHTML = `
        <div style="display:flex;flex-direction:column;gap:8px;align-items:center">
          <div style="width:100%;height:160px;border-radius:8px;overflow:hidden;background:url(${currentPreview.thumb}) center/cover"></div>
          <div class="t-center">
            <div class="tpl-title">${escapeHtml(inputName.value)}</div>
            <div class="tpl-sub">${escapeHtml(inputDate.value)}</div>
            <div class="tpl-sub">${escapeHtml(inputPlace.value)}</div>
            <div style="margin-top:8px;font-size:13px;color:#333">${escapeHtml(inputNote.value)}</div>
          </div>
        </div>
      `;
    }

    // update preview on input change
    [inputName,inputDate,inputPlace,inputNote].forEach(el=>el.addEventListener('input',renderPreview));

    // Download PNG
    document.getElementById('btnDownload').addEventListener('click', ()=>{
      html2canvas(previewArea, {scale:2}).then(canvas=>{
        const link = document.createElement('a');
        link.download = `undangan-${currentPreview.id}.png`;
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    });

    // Add to cart
    document.getElementById('btnAddToCart').addEventListener('click', ()=>{
      const item = {
        id: currentPreview.id,
        title: inputName.value + ' — ' + currentPreview.title,
        price: currentPreview.price,
        meta: {date: inputDate.value, place: inputPlace.value, note: inputNote.value}
      };
      cart.push(item);
      updateCartUI();
      previewModal.hide();
    });

    // Cart UI
    function updateCartUI(){
      document.getElementById('cartCount').innerText = cart.length;
      const list = document.getElementById('cartList'); list.innerHTML = '';
      let total = 0;
      cart.forEach((c,idx)=>{
        total += c.price;
        const row = document.createElement('div'); row.className='d-flex justify-content-between align-items-center py-2 border-bottom';
        row.innerHTML = `<div><strong>${escapeHtml(c.title)}</strong><div class="text-muted" style="font-size:12px">${escapeHtml(c.meta.date)} • ${escapeHtml(c.meta.place)}</div></div><div><div>Rp ${currency(c.price)}</div><div class="mt-1"><button class="btn btn-sm btn-outline-danger" data-idx="${idx}">Hapus</button></div></div>`;
        row.querySelector('button').addEventListener('click', (e)=>{ cart.splice(Number(e.target.dataset.idx),1); updateCartUI(); });
        list.appendChild(row);
      });
      document.getElementById('cartTotal').innerText = currency(total);
      document.getElementById('checkoutTotal').innerText = currency(total);
    }

    document.getElementById('clearCart').addEventListener('click', ()=>{ cart = []; updateCartUI(); });

    // Open Checkout modal
    const checkoutModal = new bootstrap.Modal(document.getElementById('checkoutModal'));
    document.getElementById('btnCheckout').addEventListener('click', ()=>{ if(cart.length==0) return alert('Keranjang kosong'); checkoutModal.show(); });
    document.getElementById('btnCheckoutTop').addEventListener('click', ()=>{ if(cart.length==0) return alert('Keranjang kosong'); checkoutModal.show(); });
    document.getElementById('btnCart').addEventListener('click', ()=>{ window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); });

    // Simulasi submit checkout
    document.getElementById('checkoutForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const buyerName = document.getElementById('buyerName').value;
      const buyerEmail = document.getElementById('buyerEmail').value;
      const buyerNote = document.getElementById('buyerNote').value;
      const order = {buyerName,buyerEmail,buyerNote,items:cart,total: cart.reduce((s,i)=>s+i.price,0)};
      // Untuk produksi: ganti bagian ini dengan fetch POST ke backend Anda
      console.log('Order (simulasi) ->', order);
      alert('Order berhasil (simulasi). Terima kasih, ' + buyerName);
      cart = []; updateCartUI(); checkoutModal.hide();
    });

    // Simple filters
    document.getElementById('filterAll').addEventListener('click', ()=> renderCatalog());
    document.getElementById('filterWedding').addEventListener('click', ()=> renderCatalog(templates.filter(t=> t.category==='Pernikahan')));
    document.getElementById('filterBirthday').addEventListener('click', ()=> renderCatalog(templates.filter(t=> t.category==='Ulang Tahun')));

    // Utility: escape html
    function escapeHtml(s){ return String(s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    // Initial cart UI
    updateCartUI();

  </script>
</body>
</html>
